{
  "hash": "9553fbc2a58454ca9fe071ab2391b583",
  "result": {
    "markdown": "---\ntitle: \"Kennzahlen berechnen\"\ndescription: |\n  Daten aus Verhaltensexperiments bearbeiten und zusammenfassen.\ndate: \"2022-03-20\"\nauthor:\n  - name: Andrew Ellis\n    url: https://github.com/awellis\n    affiliation: Kognitive Psychologie, Wahrnehmung und Methodenlehre, UniversitÃ¤t Bern \n    affiliation-url: https://www.kog.psy.unibe.ch\n    orcid: 0000-0002-2788-936X\nlicense: CC BY\ncitation: true\nbibliography: ../../bibliography.bib\nformat:\n    html:\n        toc: true\n        code-link: true\n---\n\n\n\n\n:::{.callout-note}\nðŸ‘‰ [R Code fÃ¼r dieses Kapitel downloaden](../../downloadable_files/summarizing-data.R)\n:::\n\n\n::: {.cell hash='summarizing-data_cache/html/unnamed-chunk-2_2309a220be6635240686ab527473b8d6'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\ndata <- read_csv(\"data_clean/rdkdata.csv\")\n```\n:::\n\nOb eine Variable als `factor` definiert ist, wird als Attribut gespeichert. Attribute werden aber in einem `.csv.` File nicht mitgespeichert; deshalb mÃ¼ssen wir die Gruppierungsvariablen wieder als `factor` definieren. \n\n\n::: {.cell hash='summarizing-data_cache/html/unnamed-chunk-3_5790e11976233dc404e84a081d9a7572'}\n\n```{.r .cell-code}\ndata <- data |>\n    mutate_if(is.character, as.factor)\n```\n:::\n\n::: {.cell hash='summarizing-data_cache/html/unnamed-chunk-4_0db6941935feca0f32845cd6336617b9'}\n\n```{.r .cell-code}\nglimpse(data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 1,440\nColumns: 9\n$ trial     <dbl> 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17â€¦\n$ ID        <fct> JH, JH, JH, JH, JH, JH, JH, JH, JH, JH, JH, JH, JH, JH, JH, â€¦\n$ cue       <fct> right, right, none, none, left, none, none, left, left, noneâ€¦\n$ direction <fct> right, right, right, right, left, right, left, left, right, â€¦\n$ response  <dbl> 1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 0, 1, 0, â€¦\n$ rt        <dbl> 0.7136441, 0.6271285, 0.6703410, 0.5738488, 0.8405913, 0.667â€¦\n$ choice    <fct> right, right, left, right, right, right, right, left, left, â€¦\n$ correct   <dbl> 1, 1, 0, 1, 0, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, â€¦\n$ condition <fct> valid, valid, neutral, neutral, valid, neutral, neutral, valâ€¦\n```\n:::\n:::\n\n\n# Binary Choices\n\n## Pro Versuchsperson\n\n\n::: {.cell hash='summarizing-data_cache/html/unnamed-chunk-5_c74c1ebf3565c7066fa1a49aa884c585'}\n\n```{.r .cell-code}\ndata\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1,440 Ã— 9\n   trial ID    cue   direction response    rt choice correct condition\n   <dbl> <fct> <fct> <fct>        <dbl> <dbl> <fct>    <dbl> <fct>    \n 1     0 JH    right right            1 0.714 right        1 valid    \n 2     1 JH    right right            1 0.627 right        1 valid    \n 3     2 JH    none  right            0 0.670 left         0 neutral  \n 4     3 JH    none  right            1 0.574 right        1 neutral  \n 5     4 JH    left  left             1 0.841 right        0 valid    \n 6     5 JH    none  right            1 0.668 right        1 neutral  \n 7     6 JH    none  left             1 1.12  right        0 neutral  \n 8     7 JH    left  left             0 0.640 left         1 valid    \n 9     8 JH    left  right            0 1.13  left         0 invalid  \n10     9 JH    none  right            1 1.03  right        1 neutral  \n# â€¦ with 1,430 more rows\n```\n:::\n:::\n\n::: {.cell hash='summarizing-data_cache/html/unnamed-chunk-6_265ab450b84699ddd4dd472996a580d1'}\n\n```{.r .cell-code}\ndata |> \n  group_by(ID, condition)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1,440 Ã— 9\n# Groups:   ID, condition [27]\n   trial ID    cue   direction response    rt choice correct condition\n   <dbl> <fct> <fct> <fct>        <dbl> <dbl> <fct>    <dbl> <fct>    \n 1     0 JH    right right            1 0.714 right        1 valid    \n 2     1 JH    right right            1 0.627 right        1 valid    \n 3     2 JH    none  right            0 0.670 left         0 neutral  \n 4     3 JH    none  right            1 0.574 right        1 neutral  \n 5     4 JH    left  left             1 0.841 right        0 valid    \n 6     5 JH    none  right            1 0.668 right        1 neutral  \n 7     6 JH    none  left             1 1.12  right        0 neutral  \n 8     7 JH    left  left             0 0.640 left         1 valid    \n 9     8 JH    left  right            0 1.13  left         0 invalid  \n10     9 JH    none  right            1 1.03  right        1 neutral  \n# â€¦ with 1,430 more rows\n```\n:::\n:::\n\n::: {.cell hash='summarizing-data_cache/html/unnamed-chunk-7_6586e3913b8e203e70a21d594cba20b4'}\n\n```{.r .cell-code}\naccuracy <- data |>\n    group_by(ID, condition) |>\n    summarise(N = n(),\n              ncorrect = sum(correct),\n              accuracy = mean(correct))\n```\n:::\n\n::: {.cell hash='summarizing-data_cache/html/unnamed-chunk-8_df0ceb7a0954b30935591c8ae0a7845b'}\n\n```{.r .cell-code}\naccuracy\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 27 Ã— 5\n# Groups:   ID [9]\n   ID    condition     N ncorrect accuracy\n   <fct> <fct>     <int>    <dbl>    <dbl>\n 1 JH    invalid      16       13   0.812 \n 2 JH    neutral      80       66   0.825 \n 3 JH    valid        64       60   0.938 \n 4 NS    invalid      16       11   0.688 \n 5 NS    neutral      80       56   0.7   \n 6 NS    valid        64       58   0.906 \n 7 rh    invalid      16        2   0.125 \n 8 rh    neutral      80       64   0.8   \n 9 rh    valid        64       61   0.953 \n10 sb    invalid      16        1   0.0625\n# â€¦ with 17 more rows\n```\n:::\n:::\n\n\n## Visualisieren\n\n\n::: {.cell hash='summarizing-data_cache/html/unnamed-chunk-9_be35b2465e0640040eeda9c6f0d3bcef'}\n\n```{.r .cell-code}\naccuracy |> \n  ggplot(aes(x = condition, y = accuracy, fill = condition)) +\n  geom_col() +\n  geom_line(aes(group = ID), size = 2) +\n  geom_point(size = 8) +\n  scale_fill_manual(\n    values = c(invalid = \"#9E0142\",\n    neutral = \"#C4C4B7\",\n    valid = \"#2EC762\")\n  ) +\n  labs(\n    x = \"Cue\",\n    y = \"Proportion correct\",\n    title = \"Accuracy per person/condition\"\n  ) +\n  theme_linedraw(base_size = 28) +\n  facet_wrap(~ID)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nâ„¹ Please use `linewidth` instead.\n```\n:::\n\n::: {.cell-output-display}\n![](summarizing-data_files/figure-html/unnamed-chunk-9-1.png){width=1440}\n:::\n:::\n\n\n## Ãœber Versuchsperson aggregieren\n\n## Ein Exkurs Ã¼ber Within-person Standardfehler \n\n\n::: {.cell hash='summarizing-data_cache/html/unnamed-chunk-10_988442bca557c1577b1f645baff8766d'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n\ndfw <- tribble(\n ~subject, ~pretest, ~posttest,\n       1,   59.4,     64.5,\n       2,   46.4,     52.4,\n       3,   46.0,     49.7,\n       4,   49.0,     48.7,\n       5,   32.5,     37.4,\n       6,   45.2,     49.5,\n       7,   60.3,     59.9,\n       8,   54.3,     54.1,\n       9,   45.4,     49.6,\n      10,   38.9,     48.5) |>\n    mutate(subject = as.factor(subject))\n```\n:::\n\n::: {.cell hash='summarizing-data_cache/html/unnamed-chunk-11_06858b555d9e23a5af221653abc932ec'}\n\n```{.r .cell-code}\ndfl <- dfw |>\n    pivot_longer(contains(\"test\"),\n                 names_to = \"condition\",\n                 values_to = \"value\") |>\n    mutate(condition = as_factor(condition))\n```\n:::\n\n::: {.cell hash='summarizing-data_cache/html/unnamed-chunk-12_fc828a0039831164f95b0ed3f46eccc4'}\n\n```{.r .cell-code}\ndflsum <- dfl |>\n    Rmisc::summarySEwithin(measurevar = \"value\",\n                               withinvars = \"condition\",\n                               idvar = \"subject\",\n                               na.rm = FALSE,\n                               conf.interval = 0.95)\n```\n:::\n\n::: {.cell hash='summarizing-data_cache/html/unnamed-chunk-13_6342c63b0e00853224b4ad7aaf121ab3'}\n\n```{.r .cell-code}\ndflsum |>\n    ggplot(aes(x = condition, y = value, group = 1)) +\n    geom_line() +\n    geom_errorbar(width = 0.1, aes(ymin = value-ci, ymax = value+ci)) +\n    geom_point(shape = 21, size = 3, fill = \"white\") +\n    ylim(40,60)\n```\n\n::: {.cell-output-display}\n![](summarizing-data_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n::: {.cell hash='summarizing-data_cache/html/unnamed-chunk-14_e1ff3e83215d2fe77b99aaa54a77a100'}\n\n```{.r .cell-code}\n# Use a consistent y range\nymax <- max(dfl$value)\nymin <- min(dfl$value)\n```\n:::\n\n::: {.cell hash='summarizing-data_cache/html/unnamed-chunk-15_7e5353fc833b843ea9676a1833b2b765'}\n\n```{.r .cell-code}\n# Plot the individuals\ndfl |>\n    ggplot(aes(x=condition, y=value, colour=subject, group=subject)) +\n    geom_line() + geom_point(shape=21, fill=\"white\") +\n    ylim(ymin,ymax)\n```\n\n::: {.cell-output-display}\n![](summarizing-data_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n::: {.cell hash='summarizing-data_cache/html/unnamed-chunk-16_1f3dc62c5f9c43dde4edf1fec5fe7823'}\n\n```{.r .cell-code}\ndfNorm_long <- Rmisc::normDataWithin(data=dfl, idvar=\"subject\", measurevar=\"value\")\n?Rmisc::normDataWithin\n\ndfNorm_long |>\n    ggplot(aes(x=condition, y=valueNormed, colour=subject, group=subject)) +\n    geom_line() + geom_point(shape=21, fill=\"white\") +\n    ylim(ymin,ymax)\n```\n\n::: {.cell-output-display}\n![](summarizing-data_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n::: {.cell hash='summarizing-data_cache/html/unnamed-chunk-17_08227ab35d237bcf9bb186a61b4eb0d0'}\n\n```{.r .cell-code}\n# Instead of summarySEwithin, use summarySE, which treats condition as though it were a between-subjects variable\ndflsum_between <- Rmisc::summarySE(data = dfl, \n                                   measurevar = \"value\", \n                                   groupvars = \"condition\", \n                                   na.rm = FALSE, \n                                   conf.interval = .95)\ndflsum_between\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  condition  N value       sd       se       ci\n1   pretest 10 47.74 8.598992 2.719240 6.151348\n2  posttest 10 51.43 7.253972 2.293907 5.189179\n```\n:::\n:::\n\n::: {.cell hash='summarizing-data_cache/html/unnamed-chunk-18_7a7ba07ea617b47634a396a283a4cb8f'}\n\n```{.r .cell-code}\n# Show the between-S CI's in red, and the within-S CI's in black\ndflsum_between |>\n    ggplot(aes(x=condition, y=value, group=1)) +\n    geom_line() +\n    geom_errorbar(width=.1, aes(ymin=value-ci, ymax=value+ci), colour=\"red\") +\n    geom_errorbar(width=.1, aes(ymin=value-ci, ymax=value+ci), data=dflsum) +\n    geom_point(shape=21, size=3, fill=\"white\") +\n    ylim(ymin,ymax)\n```\n\n::: {.cell-output-display}\n![](summarizing-data_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n\n## Within-person Standardfehler\n\n\n::: {.cell hash='summarizing-data_cache/html/unnamed-chunk-19_3349103d5341395378ad03aca9c18c72'}\n\n```{.r .cell-code}\naccuracy |> \n  ggplot(aes(x = condition, y = accuracy, colour = ID, group = ID)) +\n    geom_line() + \n  geom_point(shape=21, fill=\"white\")\n```\n\n::: {.cell-output-display}\n![](summarizing-data_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n\nDer Standardfehler is definiert als: $$SE = sd/ \\sqrt{n}$$\n\nLeider gibt es in R keine Funktion, welche den Standardfehler berechnet (schÃ¤tzt); wir kÃ¶nnen aber ganz einfach selber eine Funktion definieren.\n\n\n::: {.cell hash='summarizing-data_cache/html/unnamed-chunk-20_0ca98958f5eb45ef8a2b8d65bbf96925'}\n\n```{.r .cell-code}\nse <- function(x) sd(x)/sqrt(length(x))\n```\n:::\n\n::: {.cell hash='summarizing-data_cache/html/unnamed-chunk-21_bd506cfd67484f30b17671db57435dfc'}\n\n```{.r .cell-code}\ndatasum <- data |>\n   group_by(condition) |> \n   summarise(N = n(),\n             ccuracy = mean(correct),\n             sd = sd(correct),\n             se = se(correct))\ndatasum\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3 Ã— 5\n  condition     N ccuracy    sd     se\n  <fct>     <int>   <dbl> <dbl>  <dbl>\n1 invalid     144   0.389 0.489 0.0408\n2 neutral     720   0.629 0.483 0.0180\n3 valid       576   0.825 0.381 0.0159\n```\n:::\n:::\n\n::: {.cell hash='summarizing-data_cache/html/unnamed-chunk-22_5005fefee06d32554c40ff1239c2421a'}\n\n```{.r .cell-code}\ndatasum_2 <- data |>\n    Rmisc::summarySE(measurevar = \"correct\",\n                              groupvars = \"condition\",\n                               na.rm = FALSE,\n                               conf.interval = 0.95)\ndatasum_2\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  condition   N   correct        sd         se         ci\n1   invalid 144 0.3888889 0.4891996 0.04076663 0.08058308\n2   neutral 720 0.6291667 0.4833637 0.01801390 0.03536613\n3     valid 576 0.8246528 0.3805943 0.01585810 0.03114686\n```\n:::\n:::\n\n::: {.cell hash='summarizing-data_cache/html/unnamed-chunk-23_fbd722903e9c956ecff4e257611c07f0'}\n\n```{.r .cell-code}\ndatasum_3 <- data |>\n    Rmisc::summarySEwithin(measurevar = \"correct\",\n                               withinvars = \"condition\",\n                               idvar = \"ID\",\n                               na.rm = FALSE,\n                               conf.interval = 0.95)\ndatasum_3\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  condition   N   correct        sd         se         ci\n1   invalid 144 0.3888889 0.5773528 0.04811273 0.09510406\n2   neutral 720 0.6291667 0.5726512 0.02134145 0.04189901\n3     valid 576 0.8246528 0.4523391 0.01884746 0.03701827\n```\n:::\n:::\n\n::: {.cell hash='summarizing-data_cache/html/unnamed-chunk-24_80f0017f177bc43389c28c55537ec2e2'}\n\n```{.r .cell-code}\np_accuracy <- datasum_3 |>\n    ggplot(aes(x = condition, y = correct, group = 1)) +\n    geom_line() +\n    geom_errorbar(width = .1, aes(ymin = correct-se, ymax = correct+se), colour=\"red\") +\n    geom_point(shape=21, size=3, fill=\"white\")\np_accuracy\n```\n\n::: {.cell-output-display}\n![](summarizing-data_files/figure-html/unnamed-chunk-24-1.png){width=672}\n:::\n:::\n\n\n# Reaktionszeiten\n\n## Pro Versuchsperson\n\nWir fassen die Daten pro Person pro Block mit Mittelwert, Median und Standarabweichung zusammen.\n\n\n::: {.cell hash='summarizing-data_cache/html/unnamed-chunk-25_a7999f5d99daf983fb81448e7810c2c9'}\n\n```{.r .cell-code}\nfuns <- list(mean = mean, median = median, sd = sd)\n\nby_subj <- data %>%\n  drop_na(rt) |> \n  group_by(ID, condition) %>% \n  dplyr::summarise(across(rt, funs, .names = \"{.fn}\"))\n```\n:::\n\n::: {.cell hash='summarizing-data_cache/html/unnamed-chunk-26_0aa4d8120c693313318c0a87268d1e31'}\n\n```{.r .cell-code}\nby_subj \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 27 Ã— 5\n# Groups:   ID [9]\n   ID    condition  mean median     sd\n   <fct> <fct>     <dbl>  <dbl>  <dbl>\n 1 JH    invalid   0.775  0.739 0.163 \n 2 JH    neutral   0.799  0.733 0.202 \n 3 JH    valid     0.696  0.658 0.190 \n 4 NS    invalid   0.894  0.913 0.207 \n 5 NS    neutral   0.885  0.844 0.201 \n 6 NS    valid     0.738  0.715 0.191 \n 7 rh    invalid   0.423  0.389 0.151 \n 8 rh    neutral   0.525  0.503 0.0841\n 9 rh    valid     0.443  0.390 0.185 \n10 sb    invalid   0.376  0.341 0.0924\n# â€¦ with 17 more rows\n```\n:::\n:::\n\n\nEinfachere Version:\n\n\n::: {.cell hash='summarizing-data_cache/html/unnamed-chunk-27_03d26ffc12ed48f964dacfa72cbfcb9e'}\n\n```{.r .cell-code}\nby_subj <- data |> \n  drop_na(rt) |> \n  group_by(ID, condition) |>  \n  dplyr::summarise(mean = mean(rt),\n                   median = median(rt),\n                   sd = sd(rt))\n```\n:::\n\n::: {.cell hash='summarizing-data_cache/html/unnamed-chunk-28_14050ec4a12c92c21365e474ffbfba58'}\n\n```{.r .cell-code}\nby_subj |> \n  ggplot(aes(x = condition, y = mean, fill = condition)) +\n  geom_col() +\n  geom_line(aes(group = ID), size = 2) +\n  geom_point(size = 8) +\n  scale_fill_manual(\n    values = c(invalid = \"#9E0142\",\n    neutral = \"#C4C4B7\",\n    valid = \"#2EC762\")\n  ) +\n  labs(\n    x = \"Cue\",\n    y = \"Response time\") +\n  theme_linedraw(base_size = 28) +\n  facet_wrap(~ID)\n```\n\n::: {.cell-output-display}\n![](summarizing-data_files/figure-html/unnamed-chunk-28-1.png){width=1440}\n:::\n:::\n\n::: {.cell hash='summarizing-data_cache/html/unnamed-chunk-29_858b1ebe7769a09c6283ed2ce25ffc9e'}\n\n```{.r .cell-code}\nse <- function(x, ...) sd(x, ...)/sqrt(length(x))\n\nby_subj <- data %>% \n  group_by(ID, condition) %>% \n  summarise(mean = mean(rt, na.rm = TRUE), \n            median = median(rt, na.rm = TRUE), \n            sd = sd(rt, na.rm = TRUE), \n            se = se(rt, na.rm = TRUE))\n```\n:::\n\n::: {.cell hash='summarizing-data_cache/html/unnamed-chunk-30_409db62f02f50c18589ec8fc90b92977'}\n\n```{.r .cell-code}\nby_subj |> \n  ggplot(aes(condition, mean)) +\n  geom_line(aes(group = 1), linetype = 3) +    \n  geom_errorbar(aes(ymin = mean-se, ymax = mean+se),\n                width = 0.2, size=1, color=\"blue\") +\n  geom_point(size = 2) +\n  facet_wrap(~ID, scales = \"free_y\")\n```\n\n::: {.cell-output-display}\n![](summarizing-data_files/figure-html/unnamed-chunk-30-1.png){width=768}\n:::\n:::\n\n\n## Ãœber Versuchsperson aggregieren\n\n::: {.cell hash='summarizing-data_cache/html/unnamed-chunk-31_34ab5572e71de38d0eee74ade8783925'}\n\n```{.r .cell-code}\nrtsum <- data |>\n  drop_na(rt) |> \n    Rmisc::summarySEwithin(measurevar = \"rt\",\n                               withinvars = \"condition\",\n                               idvar = \"ID\",\n                               na.rm = FALSE,\n                               conf.interval = 0.95)\nrtsum\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  condition   N        rt        sd         se         ci\n1   invalid 141 0.7055247 0.2204498 0.01856522 0.03670444\n2   neutral 710 0.7238269 0.2449543 0.00919297 0.01804870\n3     valid 568 0.6716487 0.2482698 0.01041717 0.02046095\n```\n:::\n:::\n\n::: {.cell hash='summarizing-data_cache/html/unnamed-chunk-32_3baa3993d49072fa33d7645953aa4059'}\n\n```{.r .cell-code}\np_rt <- rtsum |>\n    ggplot(aes(x = condition, y = rt, group = 1)) +\n    geom_line() +\n    geom_errorbar(width = .1, aes(ymin = rt-se, ymax = rt+se), colour=\"red\") +\n    geom_point(shape=21, size=3, fill=\"white\")\n```\n:::\n\n::: {.cell hash='summarizing-data_cache/html/unnamed-chunk-33_037ce08c981ccf6c52749fac2de3b850'}\n\n```{.r .cell-code}\np_rt\n```\n\n::: {.cell-output-display}\n![](summarizing-data_files/figure-html/unnamed-chunk-33-1.png){width=768}\n:::\n:::\n\n::: {.cell hash='summarizing-data_cache/html/unnamed-chunk-34_381cb0b922fb244fb749d9fe3027f6f9'}\n\n```{.r .cell-code}\nlibrary(patchwork)\n```\n:::\n\n::: {.cell hash='summarizing-data_cache/html/unnamed-chunk-35_91bdc07ca3ef4a99fdd87f423d0036c1'}\n\n```{.r .cell-code}\np_accuracy / p_rt\n```\n\n::: {.cell-output-display}\n![](summarizing-data_files/figure-html/unnamed-chunk-35-1.png){width=768}\n:::\n:::",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}