{
  "hash": "5dc78fee921c9d8a18f34791e50c82a0",
  "result": {
    "markdown": "---\ntitle: \"Übung 4\"\ndescription: |\n   Untersuchung eines präsymptomatischen Indikators für die Alzheimer-Krankheit\ndate: \"2022-05-01\"\nauthor:\n  - name: Andrew Ellis\n    url: https://github.com/awellis\n    affiliation: Kognitive Psychologie, Wahrnehmung und Methodenlehre, Universität Bern \n    affiliation-url: https://www.kog.psy.unibe.ch\n    orcid: 0000-0002-2788-936X\nlicense: CC BY\ncitation: true\nbibliography: ../../bibliography.bib\nformat:\n    html:\n        toc: true\n        code-link: true\nexecute: \n  cache: false\ncode-annotations: select\n---\n\n\n\n\n\n\n:::{.callout-tip collapse=\"false\"}\n## Aufgaben\nDie Übung 4 besteht aus den zwei folgenden Aufgaben:\n\n**1. RMarkdown-File erstellen und ausführen**: In diesem File werden die Daten eingelesen, SDT Kennzahlen und damit eine Grafik erstellt. Das RMarkdown-File muss von einer anderen Person ausgeführt werden können (Reproduzierbarkeit) und gut kommentiert sein. Zeit: 1 Woche.\n\n**2. Peer Feedback**: Mittels Ilias wird Ihnen das RMarkdown-File und die Grafik einer anderen Person zugeordnet. Ihr Auftrag ist es, dieses RMarkdown-File auszuführen und Feedback zu geben. Zeit: 1 Woche.\n:::\n\n\n## Kommentare & Code\n\nAchten Sie darauf, dass Sie den Code in den Codefeldern schreiben und den Text ausserhalb. Wählen Sie aus, welche die Codechunks ausgeführt / angezeigt werden sollen.\n\n## Aufgaben\n \n- Laden Sie nötige Packages.\n\n- Laden Sie die Daten unseres Experiments. Sie finden den Datensatz `rdkdata_clean.csv` für diese Übung im Projektordner `dataviz` > `data_rdk`.\n\n- Machen Sie Textvariablen und die Personen-Id-Variable zu Faktoren und schauen Sie den Datensatz kurz an (mit `slice_head()` oder `glimpse()`), um zu überprüfen, ob die Daten richtig eingelesen wurden.\n\n- Ihre Aufgabe ist es eine Forschungsfrage zu dem vorhandenen Datensatz zu stellen, dazu eine Grafik zu plotten und die Antwort damit zu visualisieren, sowie in schriftlicher Form zu geben.\n\n    - Beschreiben Sie in Textform, welche Frage Sie mit Ihrer Grafik beantworten möchten.\n\n    - Falls nötig: Bearbeiten Sie den Datensatz / erstellen Sie einen neuen Datensatz für die Grafik.\n\n    - Erstellen Sie die Grafik, und lassen Sie diese anzeigen.\n\n    - Speichern Sie die Grafik zusätzlich als `.jpg` oder `.png` ab. So kann Ihr Peer Reviewer auch bei nicht funktionierendem Code Rückmeldung zur Grafik geben. \n    \n    - Fügen Sie der Grafik passende Beschriftungen hinzu.\n    \n    - Beantworten Sie Ihre Forschungsfrage schriftlich.\n    \n\n\n## Rey auditory verbal learning test\nIn dieser Übung werden wir die Sensitivität und den Bias für zwei Gruppen von Patienten untersuchen, die sich in ihrem Risiko für Alzheimer-Krankheit unterscheiden. Bei 60 Patienten wurde die Anwesenheit von [Beta-Amyloid](https://de.wikipedia.org/wiki/Beta-Amyloid) durch einen [Bluttest](https://www.nia.nih.gov/news/blood-test-can-predict-presence-beta-amyloid-brain-new-study-finds) \n\n\nThese data come from a clinical setting, and involve memory ability tests for 60 patients using the Rey auditory verbal learning test (RALVT: Bean, 2011)\n- in the recognition task, the patients study a set of 15 words, and tested on 30 words, made up of 15 old and 15 new words\n• Patients also had a cerebrospinal fluid measurement taken to classify their levels beta amyloid as “positive” or “negative”\n- amyloid positivity is thought to be a pre-symptomatic indicator of Alzheimer’s disease\n\n\n## Code\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- read_csv(\"data/amyloidSDT.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 60 Columns: 6\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (1): group\ndbl (5): ID, hit, miss, fa, cr\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nadd_half_count <- function(count) {\n  count + 0.5\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- df |> \n  mutate(across(c(hit, miss, fa, cr), add_half_count))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- df |>\n    mutate(\n        hit_rate = hit / (hit + miss),\n        fa_rate = fa / (fa + cr)\n    )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf |> \n  ggplot(aes(fa_rate, hit_rate, color = group)) +\n  geom_abline(intercept = 0, slope = 1, linetype = 2) +\n  geom_jitter() +\n  scale_color_viridis_d(direction = -1, begin = 0.1, end = 0.8) +\n      facet_wrap(~ group) +\n      xlim(c(0, 1)) +\n      theme_linedraw()\n```\n\n::: {.cell-output-display}\n![](loesung-4-signal-detection_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- df |>\n    mutate(\n        zhr = qnorm(hit_rate),\n        zfa = qnorm(fa_rate)\n    )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- df |>\n    mutate(\n        dprime = zhr - zfa,\n        k = -zfa,\n        c = -0.5 * (zhr + zfa)\n    )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- df |>\n    mutate(across(c(dprime, k, c), \\(x) round(x, 2)))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 60 × 13\n      ID group   hit  miss    fa    cr hit_rate fa_rate   zhr   zfa dprime     k\n   <dbl> <chr> <dbl> <dbl> <dbl> <dbl>    <dbl>   <dbl> <dbl> <dbl>  <dbl> <dbl>\n 1     1 Nega…  13.5   2.5   0.5  15.5    0.844  0.0312 1.01  -1.86   2.87  1.86\n 2     2 Nega…  12.5   3.5   1.5  14.5    0.781  0.0938 0.776 -1.32   2.09  1.32\n 3     3 Nega…  14.5   1.5   0.5  15.5    0.906  0.0312 1.32  -1.86   3.18  1.86\n 4     4 Nega…  12.5   3.5   1.5  14.5    0.781  0.0938 0.776 -1.32   2.09  1.32\n 5     5 Nega…  11.5   4.5   2.5  13.5    0.719  0.156  0.579 -1.01   1.59  1.01\n 6     6 Nega…  12.5   3.5   1.5  14.5    0.781  0.0938 0.776 -1.32   2.09  1.32\n 7     7 Nega…  10.5   5.5   2.5  13.5    0.656  0.156  0.402 -1.01   1.41  1.01\n 8     8 Nega…  13.5   2.5   1.5  14.5    0.844  0.0938 1.01  -1.32   2.33  1.32\n 9     9 Nega…  12.5   3.5   0.5  15.5    0.781  0.0312 0.776 -1.86   2.64  1.86\n10    10 Nega…  12.5   3.5   2.5  13.5    0.781  0.156  0.776 -1.01   1.79  1.01\n# ℹ 50 more rows\n# ℹ 1 more variable: c <dbl>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nse <- function(x) {\n  sd(x) / sqrt(length(x))\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndprimes <- df |>\n  select(group, dprime) |> \n  group_by(group) |> \n  summarize(mean = mean(dprime),\n            se = se(dprime))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncs <- df |> \n  select(group, c) |> \n  group_by(group) |> \n  summarize(mean = mean(c),\n            se = se(c))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\np_dprimes <- dprimes |>\n  ggplot(aes(x=group, y=mean, group=1)) +\n    geom_line() +\n    geom_errorbar(width=.1, aes(ymin=mean-se, ymax=mean+se), colour=\"black\") +\n    geom_point(shape=21, size=3, fill=\"white\") +\n    ylab(\"Sensitivity\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\np_cs <- cs |>\n    ggplot(aes(x=group, y=mean, group=1)) +\n    geom_line() +\n    geom_errorbar(width=.1, aes(ymin=mean-se, ymax=mean+se), colour=\"black\") +\n    geom_point(shape=21, size=3, fill=\"white\") +\n    ylab(\"Bias\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(patchwork)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\np_dprimes + p_cs\n```\n\n::: {.cell-output-display}\n![](loesung-4-signal-detection_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n\n\n- for healthy amyloid negative patients on the left, and potentially impaired amyloid positive patients on the right\n- the basic data change of more misses, but not many more false alarms, is captured by the model\n",
    "supporting": [
      "loesung-4-signal-detection_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}